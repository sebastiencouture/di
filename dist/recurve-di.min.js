/*! recurve-di.js - v0.1.2 - by Sebastien Couture 2015-03-18 */!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.di=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";var c=a("./utils"),d=a("./module"),e="$container";b.exports=function(a){function b(){f();var b=[];g(a,b),b=h(b),c.forEach(b,function(a){var b=a.exported();o=c.extend(o,b.services),p=c.extend(p,b.decorators)})}function f(){var b=new d;b.value(e,{load:i,invoke:j,get:k}),a.push(b)}function g(a,b){c.forEach(a,function(a){g(a.dependentModules,b),b.push(a)})}function h(a){var b=[];return c.forEach(a,function(a){-1===b.indexOf(a)&&b.push(a)}),b}function i(){c.forEach(o,function(a,b){k(b)})}function j(a,b,c){var d=m(a);return b.apply(c,d)}function k(a){if(n[a])return n[a];var b=o[a];if(c.assert(b,"no service or public service exists with the name {0}",a),0<=q.indexOf(a)){var d=q.join(" -> ");q=[],c.assert(!1,"circular dependency detected: "+d)}q.push(a);var e=j(b.dependencies,b.value);return c.assert(e,"factory {0} must return an instance",a),n[a]=l(a,e),c.assert(void 0!==n[a],"decorator {0} must return an instance",a),q.pop(),n[a]}function l(a,b){var c=p[a];if(!c)return b;var d=m(c.dependencies);return c.value.apply(null,[b].concat(d))}function m(a){var b=[];return a&&c.forEach(a,function(a){b.push(k(a))}),b}c.assert(a,"no modules specified for container"),c.isArray(a)||(a=[a]),c.assert(a.length,"no modules specified for container");var n=[],o={},p={};b();var q=[];return k(e)}},{"./module":2,"./utils":4}],2:[function(a,b){"use strict";function c(a){g.isArray(a)||(a=a?[a]:[]),this.dependentModules=a,this._services={},this._decorators={},this._exportNames=[]}function d(a,b){g.forEach(b,function(c,d){0===c.indexOf("$config")&&(b[d]="config."+a)})}function e(a,b){var c=[];return g.forEach(a,function(a,b){c.push(b)}),g.forEach(b,function(a){-1===c.indexOf(a)&&g.assert(!1,"export name {0} doesn't map to a service",a)}),c.filter(function(a){var c=!1;if(0===a.indexOf("config.")){var d=a.slice("config.".length);c=0<=b.indexOf(d)}return!c&&0>b.indexOf(a)})}function f(a,b,c){function d(b){var c=null;return g.forEach(b.dependencies,function(d,f){return d==a?(c={},c.dependencies=g.clone(b.dependencies),c.name=b.name,c.value=b.value,c.type=b.type,c.dependencies[f]=e,!1):void 0}),c}var e=g.generateUUID(),f=b[a];f&&(delete b[a],b[e]=f);var h=c[a];h&&(delete c[a],c[e]=h),g.forEach(b,function(a,c){var e=d(a);e&&(b[c]=e)}),g.forEach(c,function(a,b){var e=d(a);e&&(c[b]=e)})}var g=a("./utils");b.exports=c,c.prototype={factory:function(a,b,c){return g.assert(a,"service requires a name"),g.assert(g.isFunction(c),"factory services requires a function provider"),d(a,b),this._services[a]={dependencies:b,value:c},this},type:function(a,b,c){return g.assert(g.isFunction(c),"factory services requires a function constructor"),this.factory(a,b,function(){var a=Object.create(c.prototype);return a=c.apply(a,g.argumentsToArray(arguments))||a})},typeFactory:function(a,b,c){return g.assert(g.isFunction(c),"factory services requires a function constructor"),this.factory(a,b,function(){var a=g.argumentsToArray(arguments);return function(){var b=Object.create(c.prototype);return b=c.apply(b,a.concat(g.argumentsToArray(arguments)))||b}})},value:function(a,b){return this.factory(a,null,function(){return b})},decorator:function(a,b,c){return g.assert(a,"decorator service requires a name"),g.assert(g.isFunction(c),"decorator service requires a function provider"),d(a,b),this._decorators[a]={dependencies:b,value:c},this},config:function(a,b){return g.assert(a,"config service requires a name"),this.value("config."+a,b)},exports:function(a){this._exportNames=a},exported:function(){var a=g.extend({},this._services),b=g.extend({},this._decorators);if(this._exportNames&&0<this._exportNames.length){var c=e(this._services,this._exportNames);g.forEach(c,function(c){f(c,a,b)})}return{services:a,decorators:b}}}},{"./utils":4}],3:[function(a,b){"use strict";b.exports.Module=a("./module"),b.exports.Container=a("./container"),b.exports.VERSION="0.1.0"},{"./container":1,"./module":2}],4:[function(a,b){"use strict";function c(a,b,c){if(!a)return a;var d;if(a.forEach&&a.forEach===Object.forEach)a.forEach(b,c);else if(f(a))for(d=0;d<a.length&&!1!==b.call(c,a[d],d,a);d++);else{var e=Object.keys(a);for(d=0;d<e.length;d++){var g=e[d];if(!1===b.call(c,a[g],g,a))break}}return a}function d(a,b){if(!a||!b)return a;for(var c in b)a[c]=b[c];return a}function e(a){return h(a)?f(a)?a.slice():d({},a):a}function f(a){return a instanceof Array}function g(a){return"[object Function]"===Object.prototype.toString.call(a)}function h(a){return a===Object(a)||g(a)}function i(a,b){if(!a)throw Array.prototype.shift.apply(arguments),b=k.apply(null,arguments)||"",new Error(b)}function j(a,b){return void 0===b&&(b=0),b<a.length?Array.prototype.slice.call(a,b):[]}function k(a){if(!a)return null;var b=j(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})}function l(){var a=Date.now(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}b.exports={forEach:c,extend:d,clone:e,isArray:f,isFunction:g,isObject:h,assert:i,argumentsToArray:j,format:k,generateUUID:l}},{}]},{},[3])(3)});